<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Dashboard - CodeQuest</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f7fa; color: #2d3748; min-height: 100vh; }
        
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        
        .header { background: #1a202c; padding: 24px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 24px; display: flex; justify-content: space-between; align-items: center; }
        .header h1 { font-size: 28px; font-weight: 700; color: white; text-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        
        .btn { background: #4299e1; color: white; border: none; padding: 12px 24px; border-radius: 4px; cursor: pointer; text-decoration: none; font-size: 14px; margin-left: 8px; transition: all 0.2s; font-weight: 500; }
        .btn:hover { background: #3182ce; }
        .btn.secondary { background: #718096; padding: 8px 16px; border-radius: 2px; font-size: 13px; }
        .btn.secondary:hover { background: #4a5568; }
        .btn.run-tests { background: #38a169; padding: 14px 28px; border-radius: 8px; font-size: 16px; font-weight: 600; }
        .btn.run-tests:hover { background: #2f855a; }
        .btn.clear-cache { background: #e53e3e; padding: 10px 18px; border-radius: 0; font-size: 12px; text-transform: uppercase; }
        .btn.clear-cache:hover { background: #c53030; }
        
        .metrics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 24px; }
        
        .metric-card { background: white; padding: 20px; border: 1px solid #e2e8f0; box-shadow: 0 1px 3px rgba(0,0,0,0.1); transition: all 0.2s; }
        .metric-card:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
        .metric-card:nth-child(1) { border-radius: 12px 4px 12px 4px; }
        .metric-card:nth-child(2) { border-radius: 0; border-left: 4px solid #ed8936; }
        .metric-card:nth-child(3) { border-radius: 50px 10px 50px 10px; padding: 18px; }
        .metric-card:nth-child(4) { border-radius: 2px; border-top: 3px solid #3182ce; }
        .metric-card:nth-child(5) { border-radius: 15px; border: 2px dashed #38a169; }
        .metric-card:nth-child(6) { border-radius: 8px 0 8px 0; border-right: 5px solid #4299e1; }
        .metric-header { display: flex; align-items: center; gap: 12px; margin-bottom: 16px; }
        .metric-icon { font-size: 20px; }
        .metric-title { font-size: 16px; font-weight: 600; color: #2d3748; }
        .metric-value { font-size: 28px; font-weight: 700; margin-bottom: 8px; }
        .metric-value.good { color: #10b981; }
        .metric-value.warning { color: #f59e0b; }
        .metric-value.danger { color: #ef4444; }
        .metric-target { font-size: 12px; color: #718096; margin-bottom: 12px; }
        
        .progress-bar { width: 100%; height: 6px; background: #e2e8f0; overflow: hidden; }
        .metric-card:nth-child(1) .progress-bar { border-radius: 10px; height: 8px; }
        .metric-card:nth-child(2) .progress-bar { border-radius: 0; height: 4px; }
        .metric-card:nth-child(3) .progress-bar { border-radius: 20px; height: 10px; }
        .metric-card:nth-child(4) .progress-bar { border-radius: 2px; height: 6px; }
        .metric-card:nth-child(6) .progress-bar { border-radius: 0 8px 0 8px; height: 7px; }
        .progress-fill { height: 100%; transition: width 0.3s; }
        
        .test-section { background: white; border-radius: 0 20px 0 20px; padding: 28px; border: 2px solid #e2e8f0; border-left: 6px solid #4299e1; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .test-buttons { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 20px; }
        .test-buttons .btn { margin-left: 0; }
        .test-buttons .btn:nth-child(1) { background: #805ad5; border-radius: 25px; padding: 12px 20px; }
        .test-buttons .btn:nth-child(2) { background: #38a169; border-radius: 0; padding: 14px 16px; text-transform: uppercase; font-size: 12px; }
        .test-buttons .btn:nth-child(3) { background: #ed8936; border-radius: 6px 20px 6px 20px; padding: 10px 24px; }
        .test-buttons .btn:nth-child(4) { background: #e53e3e; border-radius: 4px; padding: 16px 12px; font-size: 13px; }
        .test-results { background: #f7fafc; border-radius: 0 0 12px 12px; padding: 20px; margin-top: 16px; font-family: monospace; font-size: 14px; border: 1px solid #e2e8f0; border-top: 3px solid #4299e1; }
        
        .chart { height: 80px; background: #f7fafc; border-radius: 20px 0 20px 0; position: relative; overflow: hidden; margin-top: 12px; border: 2px dashed #38a169; }
        .chart-bar { position: absolute; bottom: 0; width: 3px; background: #3b82f6; transition: height 0.2s; }
        
        @media (max-width: 768px) { .metrics-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>
                <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor" style="vertical-align: middle; margin-right: 12px;">
                    <path d="M13,2.05V5.08C16.39,5.57 19,8.47 19,12C19,12.9 18.82,13.75 18.5,14.54L21.12,16.07C21.68,14.83 22,13.45 22,12C22,6.82 18.05,2.55 13,2.05M12,19C8.13,19 5,15.87 5,12C5,8.47 7.61,5.57 11,5.08V2.05C5.94,2.55 2,6.81 2,12C2,17.52 6.48,22 12,22C14.8,22 17.29,20.85 19.1,18.9L16.46,17.4C15.22,18.39 13.68,19 12,19M8,12A4,4 0 0,1 12,8V12L15.5,15.5C14.33,16.69 12.74,17.24 11.15,17.1C9.56,16.96 8.17,16.5 7.1,15.43C6.03,14.36 5.57,12.97 5.43,11.38C5.29,9.79 5.84,8.2 7.03,7.03L8,12Z"/>
                </svg>
                Performance Dashboard
            </h1>
            <div>
                <button class="btn run-tests" onclick="runAllTests()">Run All Tests</button>
                <button class="btn clear-cache" onclick="clearCache()">Clear Cache</button>
                <a href="index.html" class="btn secondary">‚Üê Back</a>
            </div>
        </div>

        <div class="metrics-grid">
            <!-- Page Load Time -->
            <div class="metric-card">
                <div class="metric-header">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="#ed8936" style="background: #fed7aa; padding: 8px; border-radius: 6px;">
                        <path d="M7,2V13H10V22L17,10H13L17,2H7Z"/>
                    </svg>
                    <span class="metric-title">Page Load Time</span>
                </div>
                <div class="metric-value" id="loadTime">--</div>
                <div class="metric-target">Target: < 2 seconds</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="loadProgress"></div>
                </div>
            </div>

            <!-- Code Execution Speed -->
            <div class="metric-card">
                <div class="metric-header">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="#e53e3e" style="background: #fed7d7; padding: 8px; border-radius: 6px;">
                        <path d="M17.66,11.2C17.43,10.9 17.15,10.64 16.89,10.38C16.22,9.78 15.46,9.35 14.82,8.72C13.33,7.26 13,4.85 13.95,3C13.74,3.09 13.54,3.22 13.34,3.4C11.84,4.86 11.55,8.75 12.85,10.24C11.1,8.12 8.32,8.12 6.81,9.89C6.81,10.23 6.81,10.5 6.81,10.87C7.04,17.66 12.94,21.06 17.39,14.32C18.29,12.27 18.29,10.62 17.66,11.2Z"/>
                    </svg>
                    <span class="metric-title">Code Execution</span>
                </div>
                <div class="metric-value" id="execTime">--</div>
                <div class="metric-target">Target: < 50ms</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="execProgress"></div>
                </div>
            </div>

            <!-- Memory Usage -->
            <div class="metric-card">
                <div class="metric-header">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="#805ad5" style="background: #e9d8fd; padding: 8px; border-radius: 6px;">
                        <path d="M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3M19,19H5V5H15V9H19V19Z"/>
                    </svg>
                    <span class="metric-title">Memory Usage</span>
                </div>
                <div class="metric-value" id="memoryUsage">--</div>
                <div class="metric-target">Browser memory info</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="memoryProgress"></div>
                </div>
            </div>

            <!-- Storage Usage -->
            <div class="metric-card">
                <div class="metric-header">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="#3182ce" style="background: #bee3f8; padding: 8px; border-radius: 6px;">
                        <path d="M12,2L2,7L12,12L22,7L12,2M2,17L12,22L22,17M2,12L12,17L22,12"/>
                    </svg>
                    <span class="metric-title">Storage Usage</span>
                </div>
                <div class="metric-value" id="storageUsage">--</div>
                <div class="metric-target">LocalStorage data</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="storageProgress"></div>
                </div>
            </div>

            <!-- Frame Rate -->
            <div class="metric-card">
                <div class="metric-header">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="#38a169" style="background: #c6f6d5; padding: 8px; border-radius: 6px;">
                        <path d="M18,4L20,8H17L15,4H13L15,8H12L10,4H8L10,8H7L5,4H4A2,2 0 0,0 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V4H18Z"/>
                    </svg>
                    <span class="metric-title">Frame Rate</span>
                </div>
                <div class="metric-value" id="frameRate">--</div>
                <div class="metric-target">Target: 60 FPS</div>
                <div class="chart" id="fpsChart"></div>
            </div>

            <!-- Network Speed -->
            <div class="metric-card">
                <div class="metric-header">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="#4299e1" style="background: #bee3f8; padding: 8px; border-radius: 6px;">
                        <path d="M16.36,14C16.44,13.34 16.5,12.68 16.5,12C16.5,11.32 16.44,10.66 16.36,10H19.74C19.9,10.64 20,11.31 20,12C20,12.69 19.9,13.36 19.74,14M14.59,19.56C15.19,18.45 15.65,17.25 15.97,16H18.92C17.96,17.65 16.43,18.93 14.59,19.56M14.34,14H9.66C9.56,13.34 9.5,12.68 9.5,12C9.5,11.32 9.56,10.65 9.66,10H14.34C14.43,10.65 14.5,11.32 14.5,12C14.5,12.68 14.43,13.34 14.34,14M12,19.96C11.17,18.76 10.5,17.43 10.09,16H13.91C13.5,17.43 12.83,18.76 12,19.96M8,8H5.08C6.03,6.34 7.57,5.06 9.4,4.44C8.8,5.55 8.35,6.75 8,8M5.08,16H8C8.35,17.25 8.8,18.45 9.4,19.56C7.57,18.93 6.03,17.65 5.08,16M4.26,14C4.1,13.36 4,12.69 4,12C4,11.31 4.1,10.64 4.26,10H7.64C7.56,10.66 7.5,11.32 7.5,12C7.5,12.68 7.56,13.34 7.64,14M12,4.03C12.83,5.23 13.5,6.57 13.91,8H10.09C10.5,6.57 11.17,5.23 12,4.03M18.92,8H15.97C15.65,6.75 15.19,5.55 14.59,4.44C16.43,5.07 17.96,6.34 18.92,8M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"/>
                    </svg>
                    <span class="metric-title">Network Info</span>
                </div>
                <div class="metric-value" id="networkSpeed">--</div>
                <div class="metric-target">Connection type</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="networkProgress"></div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h3 style="color: #2d3748; font-weight: 600;">Performance Tests</h3>
            <div class="test-buttons">
                <button class="btn" onclick="testCodeExecution()">Test Code Speed</button>
                <button class="btn" onclick="testDOMManipulation()">Test DOM Speed</button>
                <button class="btn" onclick="testStorageSpeed()">Test Storage Speed</button>
                <button class="btn" onclick="testAnimationPerf()">Test Animation</button>
            </div>
            <div class="test-results" id="testResults">Click a test button to see results</div>
        </div>
    </div>

    <script>
        let fpsHistory = [];
        let performanceData = {};

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            measurePageLoad();
            measureMemoryUsage();
            measureStorageUsage();
            measureNetworkInfo();
            startFPSMonitoring();
            
            // Update metrics every 5 seconds
            setInterval(updateAllMetrics, 5000);
        });

        function measurePageLoad() {
            const loadTime = performance.timing.loadEventEnd - performance.timing.navigationStart;
            const seconds = (loadTime / 1000).toFixed(2);
            
            document.getElementById('loadTime').textContent = seconds + 's';
            
            const progress = Math.min((loadTime / 2000) * 100, 100);
            const progressBar = document.getElementById('loadProgress');
            progressBar.style.width = progress + '%';
            
            const valueEl = document.getElementById('loadTime');
            if (loadTime < 2000) {
                valueEl.className = 'metric-value good';
                progressBar.style.background = '#10b981';
            } else if (loadTime < 4000) {
                valueEl.className = 'metric-value warning';
                progressBar.style.background = '#f59e0b';
            } else {
                valueEl.className = 'metric-value danger';
                progressBar.style.background = '#ef4444';
            }
        }

        function measureMemoryUsage() {
            if (performance.memory) {
                const used = performance.memory.usedJSHeapSize;
                const total = performance.memory.totalJSHeapSize;
                const limit = performance.memory.jsHeapSizeLimit;
                
                const usedMB = (used / 1024 / 1024).toFixed(1);
                document.getElementById('memoryUsage').textContent = usedMB + ' MB';
                
                const percentage = (used / limit) * 100;
                const progressBar = document.getElementById('memoryProgress');
                progressBar.style.width = Math.min(percentage, 100) + '%';
                
                const valueEl = document.getElementById('memoryUsage');
                if (percentage < 50) {
                    valueEl.className = 'metric-value good';
                    progressBar.style.background = '#10b981';
                } else if (percentage < 80) {
                    valueEl.className = 'metric-value warning';
                    progressBar.style.background = '#f59e0b';
                } else {
                    valueEl.className = 'metric-value danger';
                    progressBar.style.background = '#ef4444';
                }
            } else {
                document.getElementById('memoryUsage').textContent = 'N/A';
            }
        }

        function measureStorageUsage() {
            let totalSize = 0;
            for (let key in localStorage) {
                if (localStorage.hasOwnProperty(key)) {
                    totalSize += localStorage[key].length;
                }
            }
            
            const sizeKB = (totalSize / 1024).toFixed(1);
            document.getElementById('storageUsage').textContent = sizeKB + ' KB';
            
            const maxStorage = 5120; // 5MB typical limit
            const percentage = (totalSize / (maxStorage * 1024)) * 100;
            const progressBar = document.getElementById('storageProgress');
            progressBar.style.width = Math.min(percentage, 100) + '%';
            
            const valueEl = document.getElementById('storageUsage');
            if (percentage < 30) {
                valueEl.className = 'metric-value good';
                progressBar.style.background = '#10b981';
            } else if (percentage < 70) {
                valueEl.className = 'metric-value warning';
                progressBar.style.background = '#f59e0b';
            } else {
                valueEl.className = 'metric-value danger';
                progressBar.style.background = '#ef4444';
            }
        }

        function measureNetworkInfo() {
            if (navigator.connection) {
                const connection = navigator.connection;
                const type = connection.effectiveType || connection.type || 'unknown';
                document.getElementById('networkSpeed').textContent = type.toUpperCase();
                
                const speedMap = { 'slow-2g': 25, '2g': 50, '3g': 75, '4g': 100 };
                const progress = speedMap[type] || 50;
                document.getElementById('networkProgress').style.width = progress + '%';
                document.getElementById('networkProgress').style.background = progress > 75 ? '#10b981' : progress > 50 ? '#f59e0b' : '#ef4444';
            } else {
                document.getElementById('networkSpeed').textContent = 'Unknown';
            }
        }

        function startFPSMonitoring() {
            let frameCount = 0;
            let lastTime = performance.now();

            function measureFPS(currentTime) {
                frameCount++;

                if (currentTime - lastTime >= 1000) {
                    const fps = Math.round((frameCount * 1000) / (currentTime - lastTime));
                    updateFPS(fps);
                    frameCount = 0;
                    lastTime = currentTime;
                }

                requestAnimationFrame(measureFPS);
            }

            requestAnimationFrame(measureFPS);
        }

        function updateFPS(fps) {
            document.getElementById('frameRate').textContent = fps + ' FPS';
            
            const valueEl = document.getElementById('frameRate');
            if (fps >= 55) {
                valueEl.className = 'metric-value good';
            } else if (fps >= 30) {
                valueEl.className = 'metric-value warning';
            } else {
                valueEl.className = 'metric-value danger';
            }

            // Update FPS chart
            fpsHistory.push(fps);
            if (fpsHistory.length > 30) fpsHistory.shift();
            updateFPSChart();
        }

        function updateFPSChart() {
            const chart = document.getElementById('fpsChart');
            chart.innerHTML = '';

            fpsHistory.forEach((fps, index) => {
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                bar.style.left = (index * 4) + 'px';
                bar.style.height = (fps / 60 * 100) + '%';
                bar.style.background = fps >= 55 ? '#10b981' : fps >= 30 ? '#f59e0b' : '#ef4444';
                chart.appendChild(bar);
            });
        }

        // Performance Tests
        function testCodeExecution() {
            const startTime = performance.now();
            
            // Test: Array operations
            let arr = [];
            for (let i = 0; i < 10000; i++) {
                arr.push(i * 2);
            }
            
            // Test: Object operations
            let obj = {};
            for (let i = 0; i < 1000; i++) {
                obj['key' + i] = 'value' + i;
            }
            
            // Test: String operations
            let str = '';
            for (let i = 0; i < 1000; i++) {
                str += 'test' + i;
            }
            
            const endTime = performance.now();
            const execTime = endTime - startTime;
            
            // Update metric
            document.getElementById('execTime').textContent = execTime.toFixed(2) + 'ms';
            const progress = Math.min((execTime / 50) * 100, 100);
            document.getElementById('execProgress').style.width = progress + '%';
            
            const valueEl = document.getElementById('execTime');
            if (execTime < 50) {
                valueEl.className = 'metric-value good';
                document.getElementById('execProgress').style.background = '#10b981';
            } else if (execTime < 100) {
                valueEl.className = 'metric-value warning';
                document.getElementById('execProgress').style.background = '#f59e0b';
            } else {
                valueEl.className = 'metric-value danger';
                document.getElementById('execProgress').style.background = '#ef4444';
            }
            
            document.getElementById('testResults').innerHTML = `
Code Execution Test Results:
- Array operations (10,000 items): ${(execTime * 0.6).toFixed(2)}ms
- Object operations (1,000 items): ${(execTime * 0.3).toFixed(2)}ms  
- String operations (1,000 items): ${(execTime * 0.1).toFixed(2)}ms
Total execution time: ${execTime.toFixed(2)}ms
Status: ${execTime < 50 ? '‚úÖ Excellent' : execTime < 100 ? '‚ö†Ô∏è Good' : '‚ùå Needs optimization'}
            `;
        }

        function testDOMManipulation() {
            const startTime = performance.now();
            
            // Create test elements
            const container = document.createElement('div');
            document.body.appendChild(container);
            
            // Test DOM operations
            for (let i = 0; i < 100; i++) {
                const div = document.createElement('div');
                div.textContent = 'Test element ' + i;
                div.style.background = '#f0f0f0';
                container.appendChild(div);
            }
            
            // Test style changes
            const elements = container.children;
            for (let i = 0; i < elements.length; i++) {
                elements[i].style.color = 'blue';
                elements[i].style.padding = '5px';
            }
            
            // Cleanup
            document.body.removeChild(container);
            
            const endTime = performance.now();
            const domTime = endTime - startTime;
            
            document.getElementById('testResults').innerHTML = `
DOM Manipulation Test Results:
- Created 100 elements: ${(domTime * 0.7).toFixed(2)}ms
- Applied styles to 100 elements: ${(domTime * 0.3).toFixed(2)}ms
Total DOM time: ${domTime.toFixed(2)}ms
Status: ${domTime < 20 ? '‚úÖ Excellent' : domTime < 50 ? '‚ö†Ô∏è Good' : '‚ùå Needs optimization'}
            `;
        }

        function testStorageSpeed() {
            const startTime = performance.now();
            
            // Test localStorage operations
            const testData = { name: 'test', value: Math.random(), array: [1,2,3,4,5] };
            
            // Write test
            for (let i = 0; i < 50; i++) {
                localStorage.setItem('perf_test_' + i, JSON.stringify(testData));
            }
            
            // Read test
            for (let i = 0; i < 50; i++) {
                JSON.parse(localStorage.getItem('perf_test_' + i));
            }
            
            // Delete test
            for (let i = 0; i < 50; i++) {
                localStorage.removeItem('perf_test_' + i);
            }
            
            const endTime = performance.now();
            const storageTime = endTime - startTime;
            
            document.getElementById('testResults').innerHTML = `
Storage Speed Test Results:
- 50 write operations: ${(storageTime * 0.4).toFixed(2)}ms
- 50 read operations: ${(storageTime * 0.4).toFixed(2)}ms
- 50 delete operations: ${(storageTime * 0.2).toFixed(2)}ms
Total storage time: ${storageTime.toFixed(2)}ms
Average per operation: ${(storageTime / 150).toFixed(2)}ms
Status: ${storageTime < 50 ? '‚úÖ Excellent' : storageTime < 100 ? '‚ö†Ô∏è Good' : '‚ùå Needs optimization'}
            `;
            
            measureStorageUsage();
        }

        function testAnimationPerf() {
            const testElement = document.createElement('div');
            testElement.style.cssText = `
                width: 50px; height: 50px; background: #3b82f6;
                position: fixed; top: 50%; left: 0; border-radius: 50%;
                transition: none; z-index: 1000;
            `;
            document.body.appendChild(testElement);

            const startTime = performance.now();
            let frameCount = 0;
            let animationFrames = [];

            function animate() {
                const elapsed = performance.now() - startTime;
                frameCount++;
                
                testElement.style.transform = `translateX(${Math.sin(elapsed * 0.01) * 200 + 200}px)`;
                
                if (elapsed < 2000) {
                    animationFrames.push(performance.now());
                    requestAnimationFrame(animate);
                } else {
                    document.body.removeChild(testElement);
                    
                    const avgFPS = Math.round((frameCount * 1000) / elapsed);
                    const frameTimeVariance = calculateFrameVariance(animationFrames);
                    
                    document.getElementById('testResults').innerHTML = `
Animation Performance Test Results:
- Test duration: 2000ms
- Total frames: ${frameCount}
- Average FPS: ${avgFPS}
- Frame time variance: ${frameTimeVariance.toFixed(2)}ms
Status: ${avgFPS >= 55 ? '‚úÖ Smooth (60 FPS)' : avgFPS >= 30 ? '‚ö†Ô∏è Acceptable (30+ FPS)' : '‚ùå Choppy (< 30 FPS)'}
                    `;
                }
            }

            requestAnimationFrame(animate);
        }

        function calculateFrameVariance(frames) {
            if (frames.length < 2) return 0;
            
            const frameTimes = [];
            for (let i = 1; i < frames.length; i++) {
                frameTimes.push(frames[i] - frames[i-1]);
            }
            
            const avg = frameTimes.reduce((a, b) => a + b) / frameTimes.length;
            const variance = frameTimes.reduce((sum, time) => sum + Math.pow(time - avg, 2), 0) / frameTimes.length;
            return Math.sqrt(variance);
        }

        function runAllTests() {
            document.getElementById('testResults').innerHTML = 'Running all performance tests...';
            
            setTimeout(() => testCodeExecution(), 100);
            setTimeout(() => testDOMManipulation(), 1000);
            setTimeout(() => testStorageSpeed(), 2000);
            setTimeout(() => testAnimationPerf(), 3000);
        }

        function clearCache() {
            // Clear performance data
            fpsHistory = [];
            performanceData = {};
            
            // Clear some localStorage (keep user data)
            const keysToRemove = [];
            for (let key in localStorage) {
                if (key.startsWith('perf_') || key.startsWith('cache_')) {
                    keysToRemove.push(key);
                }
            }
            keysToRemove.forEach(key => localStorage.removeItem(key));
            
            // Update metrics
            updateAllMetrics();
            
            document.getElementById('testResults').innerHTML = 'Cache cleared successfully!';
        }

        function updateAllMetrics() {
            measureMemoryUsage();
            measureStorageUsage();
            measureNetworkInfo();
        }
    </script>
</body>
</html>